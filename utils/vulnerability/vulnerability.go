package vulnerability

import (
	"fmt"
	"strings"

	log "github.com/sirupsen/logrus"
)

const (
	Defcon1Vulnerability    = "DEFCON1"
	CriticalVulnerability   = "CRITICAL"
	HighVulnerability       = "HIGH"
	MediumVulnerability     = "MEDIUM"
	LowVulnerability        = "LOW"
	NegligibleVulnerability = "NEGLIGIBLE"
	UnknownVulnerability    = "UNKNOWN"
)

func GetSeverityFromString(severity string) int {
	switch strings.ToUpper(severity) {
	case Defcon1Vulnerability:
		return 6
	case CriticalVulnerability:
		return 5
	case HighVulnerability:
		return 4
	case MediumVulnerability:
		return 3
	case LowVulnerability:
		return 2
	case NegligibleVulnerability:
		return 1
	case UnknownVulnerability:
		return 0
	default:
		log.Warnf("invalid severity %v", severity)
		return 0
	}
}

func ValidateSeverity(severity string) error {
	switch strings.ToUpper(severity) {
	case Defcon1Vulnerability, CriticalVulnerability, HighVulnerability, MediumVulnerability, LowVulnerability, NegligibleVulnerability, UnknownVulnerability:
		return nil
	default:
		return fmt.Errorf("invalid severity: %v", severity)
	}
}
